================================================================================
                              AULA 02 - DIA 2
                  DDL - CRIA√á√ÉO DE ESTRUTURAS E TIPOS DE DADOS
================================================================================

HOR√ÅRIO: 13:30 - 17:30 (4 horas)
DATA: _____/_____/_____

================================================================================
                            OBJETIVOS DA AULA
================================================================================

Ao final desta aula, voc√™ ser√° capaz de:
‚úì Dominar CREATE TABLE com diversos tipos de dados
‚úì Aplicar constraints b√°sicas (NOT NULL, DEFAULT, UNIQUE)
‚úì Usar SERIAL para auto-incremento
‚úì Trabalhar com tipos de dados: INTEGER, VARCHAR, DATE, BOOLEAN, DECIMAL
‚úì Compreender quando usar cada tipo de dado

================================================================================
                          CRONOGRAMA DA AULA
================================================================================

13:30 - 13:45 (15 min) ‚Üí Revis√£o Aula Anterior + Quiz
13:45 - 14:45 (60 min) ‚Üí Tipos de Dados do PostgreSQL
14:45 - 15:30 (45 min) ‚Üí Constraints B√°sicas (NOT NULL, DEFAULT, UNIQUE)
15:30 - 15:45 (15 min) ‚Üí ‚òï INTERVALO
15:45 - 17:00 (75 min) ‚Üí Pr√°tica: Criar Tabelas Complexas
17:00 - 17:30 (30 min) ‚Üí Exerc√≠cios Pr√°ticos

================================================================================
     PARTE 1: TIPOS DE DADOS DO POSTGRESQL (13:45 - 14:45)
================================================================================

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë 1.1 TIPOS NUM√âRICOS                                                        ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

üìå N√öMEROS INTEIROS:

   SMALLINT    ‚Üí -32.768 a 32.767 (2 bytes)
   INTEGER     ‚Üí -2 bilh√µes a 2 bilh√µes (4 bytes) ‚Üê MAIS USADO
   BIGINT      ‚Üí -9 quintilh√µes a 9 quintilh√µes (8 bytes)
   
   SERIAL      ‚Üí INTEGER com auto-incremento (1, 2, 3...)
   BIGSERIAL   ‚Üí BIGINT com auto-incremento

-- Exemplo pr√°tico:
CREATE TABLE produtos (
    id SERIAL PRIMARY KEY,          -- Auto-incrementa: 1, 2, 3...
    codigo_barras BIGINT UNIQUE,    -- C√≥digos longos: 7891234567890
    estoque INTEGER,                -- Quantidade em estoque
    nivel_alerta SMALLINT           -- N√∫meros pequenos
);

/*
   üí° QUANDO USAR SERIAL?
   - Chaves prim√°rias (ID)
   - N√£o precisa inserir o valor, √© autom√°tico!
   
   INSERT INTO produtos (codigo_barras, estoque) 
   VALUES (7891234567890, 100);
   -- id ser√° gerado automaticamente como 1
*/


üìå N√öMEROS DECIMAIS (Com casas decimais):

   DECIMAL(p, s)  ‚Üí Precis√£o exata ‚Üê Use para DINHEIRO!
   NUMERIC(p, s)  ‚Üí Id√™ntico a DECIMAL
   REAL           ‚Üí Precis√£o simples (~6 d√≠gitos)
   DOUBLE PRECISION ‚Üí Precis√£o dupla (~15 d√≠gitos)
   
   p = precis√£o total (d√≠gitos totais)
   s = escala (d√≠gitos ap√≥s v√≠rgula)

-- Exemplo pr√°tico:
CREATE TABLE financeiro (
    id SERIAL PRIMARY KEY,
    preco DECIMAL(10, 2),      -- 10 d√≠gitos, 2 ap√≥s v√≠rgula
                               -- Ex: 12345678.90
    desconto DECIMAL(5, 2),    -- Ex: 999.99 (porcentagem)
    taxa_juros REAL            -- Ex: 0.0575 (5.75%)
);

/*
   üí∞ REGRA DE OURO:
   SEMPRE use DECIMAL/NUMERIC para valores monet√°rios!
   NUNCA use REAL ou DOUBLE para dinheiro (erro de arredondamento)
   
   ‚úÖ Correto: preco DECIMAL(10,2)
   ‚ùå Errado:  preco REAL
*/

-- Inserindo valores decimais:
INSERT INTO financeiro (preco, desconto, taxa_juros) 
VALUES (1599.99, 15.50, 0.0575);

-- Opera√ß√µes com decimais:
SELECT 
    preco,
    preco * (desconto / 100) AS valor_desconto,
    preco - (preco * desconto / 100) AS preco_final
FROM financeiro;


‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë 1.2 TIPOS DE TEXTO (STRINGS)                                              ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

   CHAR(n)         ‚Üí Tamanho FIXO, preenche com espa√ßos
   VARCHAR(n)      ‚Üí Tamanho VARI√ÅVEL, at√© n caracteres ‚Üê MAIS USADO
   TEXT            ‚Üí Tamanho ilimitado

-- Exemplo pr√°tico:
CREATE TABLE clientes (
    id SERIAL PRIMARY KEY,
    cpf CHAR(11),              -- CPF sempre tem 11 d√≠gitos
    nome VARCHAR(150),         -- Nomes variam de tamanho
    email VARCHAR(100),        -- Emails at√© 100 caracteres
    observacoes TEXT           -- Coment√°rios longos, sem limite
);

/*
   üìè DIFEREN√áAS:
   
   CHAR(5):    'AB'    ‚Üí armazenado como 'AB   ' (3 espa√ßos)
   VARCHAR(5): 'AB'    ‚Üí armazenado como 'AB' (sem espa√ßos)
   TEXT:       'AB...' ‚Üí qualquer tamanho
   
   üí° QUANDO USAR CADA UM?
   CHAR(n)    ‚Üí Tamanho sempre igual (CPF, CEP, c√≥digo fixo)
   VARCHAR(n) ‚Üí Tamanho varia (nome, email, endere√ßo)
   TEXT       ‚Üí N√£o sabe o tamanho (descri√ß√£o, coment√°rios)
*/

-- Inserindo textos:
INSERT INTO clientes (cpf, nome, email, observacoes) VALUES
    ('12345678901', 'Ana Silva', 'ana@email.com', 'Cliente VIP'),
    ('98765432100', 'Jo√£o Santos', 'joao@email.com', NULL);

-- üí° NULL significa "sem valor", diferente de '' (vazio)


‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë 1.3 TIPOS DE DATA E HORA                                                  ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

   DATE            ‚Üí Apenas data: 2025-12-01
   TIME            ‚Üí Apenas hora: 14:30:00
   TIMESTAMP       ‚Üí Data + hora: 2025-12-01 14:30:00
   TIMESTAMPTZ     ‚Üí Com fuso hor√°rio
   INTERVAL        ‚Üí Per√≠odo de tempo: 3 days, 2 hours

-- Exemplo pr√°tico:
CREATE TABLE eventos (
    id SERIAL PRIMARY KEY,
    nome VARCHAR(100),
    data_evento DATE,
    hora_inicio TIME,
    data_hora_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    duracao INTERVAL
);

/*
   üí° CURRENT_TIMESTAMP
   Fun√ß√£o que retorna data/hora atual do servidor
   √ötil para campos "criado_em", "atualizado_em"
*/

-- Inserindo datas:
INSERT INTO eventos (nome, data_evento, hora_inicio, duracao) VALUES
    ('Reuni√£o', '2025-12-15', '14:00:00', '2 hours'),
    ('Treinamento', '2025-12-20', '09:30:00', '4 hours 30 minutes');

-- Formato de data no PostgreSQL: 'YYYY-MM-DD' (Ano-M√™s-Dia)

-- Consultas com datas:
SELECT nome, data_evento 
FROM eventos 
WHERE data_evento > '2025-12-10';

-- Fun√ß√µes √∫teis de data:
SELECT 
    NOW(),                          -- Data/hora atual
    CURRENT_DATE,                   -- Apenas data atual
    CURRENT_TIME,                   -- Apenas hora atual
    AGE('2025-12-01', '2000-01-01'), -- Diferen√ßa entre datas
    EXTRACT(YEAR FROM CURRENT_DATE); -- Extrair parte da data


‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë 1.4 TIPO BOOLEANO (VERDADEIRO/FALSO)                                      ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

   BOOLEAN ‚Üí TRUE, FALSE ou NULL

-- Exemplo pr√°tico:
CREATE TABLE usuarios (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50),
    email VARCHAR(100),
    ativo BOOLEAN DEFAULT TRUE,    -- Usu√°rio ativo por padr√£o
    admin BOOLEAN DEFAULT FALSE    -- N√£o √© admin por padr√£o
);

-- Inserindo valores booleanos:
INSERT INTO usuarios (username, email, ativo, admin) VALUES
    ('joao123', 'joao@email.com', TRUE, FALSE),
    ('admin', 'admin@email.com', TRUE, TRUE),
    ('maria_x', 'maria@email.com', FALSE, FALSE);

-- Consultando booleanos:
SELECT * FROM usuarios WHERE ativo = TRUE;
SELECT * FROM usuarios WHERE ativo;  -- Forma curta
SELECT * FROM usuarios WHERE NOT ativo;  -- Inativos

/*
   üí° VALORES ACEITOS PARA BOOLEAN:
   TRUE:  TRUE, 't', 'true', 'y', 'yes', '1'
   FALSE: FALSE, 'f', 'false', 'n', 'no', '0'
*/


‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë 1.5 OUTROS TIPOS √öTEIS                                                     ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

-- UUID (Identificador √önico Universal)
CREATE TABLE sessoes (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    usuario_id INTEGER,
    token TEXT
);

-- JSON / JSONB (dados em formato JSON)
CREATE TABLE configuracoes (
    id SERIAL PRIMARY KEY,
    chave VARCHAR(50),
    valor JSONB  -- JSONB √© mais r√°pido que JSON
);

INSERT INTO configuracoes (chave, valor) VALUES
    ('tema', '{"cor": "azul", "fonte": "Arial"}');

-- ARRAY (listas/vetores)
CREATE TABLE turmas (
    id SERIAL PRIMARY KEY,
    nome VARCHAR(50),
    dias_semana TEXT[]  -- Array de textos
);

INSERT INTO turmas (nome, dias_semana) VALUES
    ('Turma A', ARRAY['Segunda', 'Quarta', 'Sexta']);


================================================================================
     PARTE 2: CONSTRAINTS B√ÅSICAS (14:45 - 15:30)
================================================================================

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë 2.1 NOT NULL (N√ÉO NULO - CAMPO OBRIGAT√ìRIO)                               ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

-- NOT NULL for√ßa o campo a ter valor
CREATE TABLE funcionarios (
    id SERIAL PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,    -- Nome √© obrigat√≥rio
    cpf CHAR(11) NOT NULL,         -- CPF √© obrigat√≥rio
    email VARCHAR(100),            -- Email √© opcional (pode ser NULL)
    salario DECIMAL(10,2) NOT NULL -- Sal√°rio √© obrigat√≥rio
);

-- ‚úÖ Inser√ß√£o v√°lida:
INSERT INTO funcionarios (nome, cpf, salario) 
VALUES ('Pedro Silva', '12345678901', 3500.00);

-- ‚ùå Erro - nome √© NOT NULL:
-- INSERT INTO funcionarios (cpf, salario) 
-- VALUES ('98765432100', 4000.00);
-- ERROR: null value in column "nome" violates not-null constraint

/*
   üí° QUANDO USAR NOT NULL?
   - Dados essenciais (nome, CPF, email em cadastro)
   - Valores que sempre devem existir
   - Evita dados incompletos no banco
*/


‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë 2.2 DEFAULT (VALOR PADR√ÉO)                                                ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

-- DEFAULT define valor autom√°tico se n√£o informado
CREATE TABLE pedidos (
    id SERIAL PRIMARY KEY,
    cliente_id INTEGER NOT NULL,
    data_pedido DATE DEFAULT CURRENT_DATE,     -- Data de hoje
    status VARCHAR(20) DEFAULT 'PENDENTE',     -- Status padr√£o
    desconto DECIMAL(5,2) DEFAULT 0.00,        -- Sem desconto
    ativo BOOLEAN DEFAULT TRUE                 -- Ativo por padr√£o
);

-- Se n√£o informar os campos com DEFAULT, usam o valor padr√£o:
INSERT INTO pedidos (cliente_id) VALUES (10);
-- data_pedido = data de hoje
-- status = 'PENDENTE'
-- desconto = 0.00
-- ativo = TRUE

-- Pode sobrescrever o DEFAULT:
INSERT INTO pedidos (cliente_id, status, desconto) 
VALUES (20, 'APROVADO', 10.50);

/*
   üí° BOAS PR√ÅTICAS:
   - Use DEFAULT para campos que t√™m valor "normal"
   - Combine com NOT NULL quando apropriado
   - Exemplos comuns: status inicial, datas de cria√ß√£o, flags
*/


‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë 2.3 UNIQUE (VALOR √öNICO)                                                  ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

-- UNIQUE garante que n√£o h√° valores duplicados
CREATE TABLE contas (
    id SERIAL PRIMARY KEY,
    email VARCHAR(100) UNIQUE NOT NULL,  -- Email √∫nico
    cpf CHAR(11) UNIQUE,                 -- CPF √∫nico (pode ser NULL)
    username VARCHAR(50) UNIQUE NOT NULL -- Username √∫nico
);

-- ‚úÖ Inser√ß√£o v√°lida:
INSERT INTO contas (email, cpf, username) 
VALUES ('joao@email.com', '12345678901', 'joao123');

-- ‚ùå Erro - email j√° existe:
-- INSERT INTO contas (email, cpf, username) 
-- VALUES ('joao@email.com', '98765432100', 'maria456');
-- ERROR: duplicate key value violates unique constraint "contas_email_key"

/*
   üí° DIFEREN√áA: UNIQUE vs PRIMARY KEY
   
   PRIMARY KEY = UNIQUE + NOT NULL (apenas 1 por tabela)
   UNIQUE = permite NULL (pode ter v√°rios por tabela)
   
   Exemplo:
   - id ‚Üí PRIMARY KEY
   - email, cpf, username ‚Üí UNIQUE
*/

-- UNIQUE em m√∫ltiplas colunas (combina√ß√£o √∫nica):
CREATE TABLE inscricoes (
    id SERIAL PRIMARY KEY,
    aluno_id INTEGER,
    curso_id INTEGER,
    UNIQUE (aluno_id, curso_id)  -- Aluno n√£o pode se inscrever 2x no mesmo curso
);


‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë 2.4 CHECK (VALIDA√á√ÉO PERSONALIZADA)                                       ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

-- CHECK valida condi√ß√µes customizadas
CREATE TABLE pessoas (
    id SERIAL PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    idade INTEGER CHECK (idade >= 0 AND idade <= 150),  -- Idade v√°lida
    email VARCHAR(100) CHECK (email LIKE '%@%'),        -- Deve ter @
    sexo CHAR(1) CHECK (sexo IN ('M', 'F', 'O')),      -- M, F ou O
    salario DECIMAL(10,2) CHECK (salario > 0)          -- Sal√°rio positivo
);

-- ‚úÖ Inser√ß√£o v√°lida:
INSERT INTO pessoas (nome, idade, email, sexo, salario) 
VALUES ('Ana Costa', 28, 'ana@email.com', 'F', 3500.00);

-- ‚ùå Erro - idade inv√°lida:
-- INSERT INTO pessoas (nome, idade, email, sexo, salario) 
-- VALUES ('Jo√£o', -5, 'joao@email.com', 'M', 3000.00);
-- ERROR: new row violates check constraint "pessoas_idade_check"

-- ‚ùå Erro - email sem @:
-- INSERT INTO pessoas (nome, idade, email, sexo, salario) 
-- VALUES ('Maria', 25, 'maria.com', 'F', 3000.00);

/*
   üí° OPERADORES √öTEIS EM CHECK:
   =, <>, <, >, <=, >=      ‚Üí Compara√ß√£o
   AND, OR, NOT             ‚Üí L√≥gicos
   BETWEEN ... AND ...      ‚Üí Entre valores
   IN (val1, val2, ...)     ‚Üí Em lista
   LIKE 'padr√£o'            ‚Üí Correspond√™ncia de texto
       % = qualquer sequ√™ncia
       _ = um caractere
*/


================================================================================
     PARTE 3: PR√ÅTICA - TABELAS COMPLEXAS (15:45 - 17:00)
================================================================================

-- EXEMPLO COMPLETO: Sistema de Biblioteca

-- Tabela de autores
CREATE TABLE autores (
    id SERIAL PRIMARY KEY,
    nome VARCHAR(150) NOT NULL,
    nacionalidade VARCHAR(50),
    data_nascimento DATE,
    biografia TEXT
);

-- Tabela de livros
CREATE TABLE livros (
    id SERIAL PRIMARY KEY,
    isbn CHAR(13) UNIQUE NOT NULL,
    titulo VARCHAR(200) NOT NULL,
    autor_id INTEGER NOT NULL,  -- Ser√° foreign key (pr√≥xima aula)
    ano_publicacao INTEGER CHECK (ano_publicacao >= 1000 AND ano_publicacao <= 2100),
    paginas INTEGER CHECK (paginas > 0),
    preco DECIMAL(10,2) CHECK (preco >= 0),
    estoque INTEGER DEFAULT 0 CHECK (estoque >= 0),
    disponivel BOOLEAN DEFAULT TRUE,
    data_cadastro TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Tabela de membros da biblioteca
CREATE TABLE membros (
    id SERIAL PRIMARY KEY,
    numero_carteirinha VARCHAR(20) UNIQUE NOT NULL,
    nome_completo VARCHAR(150) NOT NULL,
    cpf CHAR(11) UNIQUE,
    email VARCHAR(100) UNIQUE NOT NULL CHECK (email LIKE '%@%'),
    telefone VARCHAR(15),
    data_nascimento DATE NOT NULL,
    data_cadastro DATE DEFAULT CURRENT_DATE,
    ativo BOOLEAN DEFAULT TRUE,
    tipo_membro VARCHAR(20) DEFAULT 'REGULAR' CHECK (tipo_membro IN ('REGULAR', 'PREMIUM', 'ESTUDANTE'))
);

-- Inserindo dados:
INSERT INTO autores (nome, nacionalidade, data_nascimento) VALUES
    ('Machado de Assis', 'Brasileiro', '1839-06-21'),
    ('Clarice Lispector', 'Brasileira', '1920-12-10'),
    ('Paulo Coelho', 'Brasileiro', '1947-08-24');

INSERT INTO livros (isbn, titulo, autor_id, ano_publicacao, paginas, preco, estoque) VALUES
    ('9788535911664', 'Dom Casmurro', 1, 1899, 256, 35.90, 10),
    ('9788520925683', 'A Hora da Estrela', 2, 1977, 88, 28.50, 5),
    ('9788542212938', 'O Alquimista', 3, 1988, 224, 42.90, 15);

INSERT INTO membros (numero_carteirinha, nome_completo, cpf, email, data_nascimento, tipo_membro) VALUES
    ('BIB001', 'Pedro Alves da Silva', '12345678901', 'pedro@email.com', '1995-03-15', 'REGULAR'),
    ('BIB002', 'Julia Mendes Santos', '98765432100', 'julia@email.com', '2000-07-22', 'ESTUDANTE'),
    ('BIB003', 'Carlos Eduardo Lima', '11122233344', 'carlos@email.com', '1988-11-30', 'PREMIUM');

-- Consultas √∫teis:
SELECT * FROM livros WHERE preco > 30 ORDER BY preco DESC;
SELECT * FROM membros WHERE ativo = TRUE AND tipo_membro = 'ESTUDANTE';
SELECT titulo, preco, estoque FROM livros WHERE disponivel AND estoque < 10;


================================================================================
                    EXERC√çCIOS PR√ÅTICOS (17:00 - 17:30)
================================================================================

üí™ EXERC√çCIO 1: CRIAR TABELA DE PRODUTOS (15 min)

Crie uma tabela chamada "produtos_loja" com:
- id (auto-incremento, chave prim√°ria)
- codigo_produto (texto 20 caracteres, √∫nico, obrigat√≥rio)
- nome (texto 100 caracteres, obrigat√≥rio)
- descricao (texto longo)
- preco_custo (decimal 10,2, obrigat√≥rio, maior que 0)
- preco_venda (decimal 10,2, obrigat√≥rio, maior que preco_custo)
- estoque_atual (inteiro, padr√£o 0, n√£o negativo)
- estoque_minimo (inteiro, padr√£o 10, n√£o negativo)
- peso_kg (decimal 8,3, deve ser positivo)
- categoria (texto 50 caracteres)
- ativo (booleano, padr√£o verdadeiro)
- data_cadastro (timestamp, padr√£o data/hora atual)

DICA: Use CHECK para validar preco_venda > preco_custo

# RESOLU√á√ÉO EXEMPLO:
CREATE TABLE produtos_loja (
    id SERIAL PRIMARY KEY,

    codigo_produto VARCHAR(20) UNIQUE NOT NULL,
    nome VARCHAR(100) NOT NULL,
    descricao TEXT,

    preco_custo DECIMAL(10,2) NOT NULL CHECK (preco_custo > 0),
    preco_venda DECIMAL(10,2) NOT NULL CHECK (preco_venda > preco_custo),

    estoque_atual INT DEFAULT 0 CHECK (estoque_atual >= 0),
    estoque_minimo INT DEFAULT 10 CHECK (estoque_minimo >= 0),

    peso_kg DECIMAL(8,3) CHECK (peso_kg > 0),

    categoria VARCHAR(50),

    ativo BOOLEAN DEFAULT TRUE,

    data_cadastro TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);


‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üí™ EXERC√çCIO 2: INSERIR PRODUTOS (10 min)

Insira 5 produtos variados na tabela criada:
- Notebook Dell (R$ 2500 custo, R$ 3200 venda)
- Mouse Logitech (R$ 45 custo, R$ 75 venda)
- Teclado Mec√¢nico (R$ 180 custo, R$ 299 venda)
- Monitor LG 24" (R$ 550 custo, R$ 899 venda)
- Webcam HD (R$ 120 custo, R$ 199 venda)

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üí™ EXERC√çCIO 3: CRIAR TABELA DE FUNCION√ÅRIOS (15 min)

Crie uma tabela "funcionarios_empresa" com:
- id (auto-incremento, PK)
- matricula (texto 10 caracteres, √∫nico, obrigat√≥rio)
- nome_completo (texto 150, obrigat√≥rio)
- cpf (texto 11, √∫nico, obrigat√≥rio)
- email (texto 100, √∫nico, obrigat√≥rio, deve conter @)
- telefone (texto 15)
- data_nascimento (data, obrigat√≥ria)
- data_admissao (data, padr√£o data atual)
- cargo (texto 50, obrigat√≥rio)
- salario (decimal 10,2, deve ser >= 1320.00)
- departamento (texto 50)
- ativo (booleano, padr√£o verdadeiro)
- turno (texto 10, deve ser: 'MANH√É', 'TARDE', 'NOITE' ou 'INTEGRAL')

-- Cria√ß√£o da tabela "funcionarios_empresa" conforme solicitado

CREATE TABLE funcionarios_empresa (
    id SERIAL PRIMARY KEY,

    -- Matr√≠cula: texto fixo, √∫nica e obrigat√≥ria
    matricula VARCHAR(10) NOT NULL UNIQUE,

    -- Nome completo
    nome_completo VARCHAR(150) NOT NULL,

    -- CPF com 11 caracteres, obrigat√≥rio e √∫nico
    cpf VARCHAR(11) NOT NULL UNIQUE,

    -- E-mail obrigat√≥rio, √∫nico e deve conter '@'
    email VARCHAR(100) NOT NULL UNIQUE
        CHECK (POSITION('@' IN email) > 0),

    -- Telefone opcional
    telefone VARCHAR(15),

    -- Data de nascimento obrigat√≥ria
    data_nascimento DATE NOT NULL,

    -- Data de admiss√£o com padr√£o da data atual
    data_admissao DATE DEFAULT CURRENT_DATE,

    -- Cargo obrigat√≥rio
    cargo VARCHAR(50) NOT NULL,

    -- Sal√°rio m√≠nimo de 1320,00
    salario NUMERIC(10,2) NOT NULL
        CHECK (salario >= 1320.00),

    -- Departamento opcional
    departamento VARCHAR(50),

    -- Funcion√°rio ativo por padr√£o
    ativo BOOLEAN DEFAULT TRUE,

    -- Turno com valores limitados
    turno VARCHAR(10) NOT NULL
        CHECK (turno IN ('MANH√É', 'TARDE', 'NOITE', 'INTEGRAL'))
);



‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üí™ DESAFIO EXTRA:

Crie uma tabela "vendas" que registre:
- id, numero_nota_fiscal (√∫nico), data_venda, valor_total
- forma_pagamento (apenas: 'DINHEIRO', 'CARTAO', 'PIX', 'BOLETO')
- status_pagamento (apenas: 'PENDENTE', 'PAGO', 'CANCELADO')
- Use DEFAULT para data_venda e status_pagamento

-- Cria√ß√£o da tabela "vendas" com todas as regras solicitadas

CREATE TABLE vendas (
    id SERIAL PRIMARY KEY,
    
    -- N√∫mero da nota fiscal, valor √∫nico
    numero_nota_fiscal VARCHAR(30) NOT NULL UNIQUE,
    
    -- Data da venda: recebe a data/hora atual automaticamente
    data_venda TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    -- Valor total da venda
    valor_total NUMERIC(10,2) NOT NULL CHECK (valor_total >= 0),
    
    -- Forma de pagamento limitada aos valores permitidos
    forma_pagamento VARCHAR(20) NOT NULL
        CHECK (forma_pagamento IN ('DINHEIRO', 'CARTAO', 'PIX', 'BOLETO')),
    
    -- Status do pagamento limitado aos valores permitidos, com valor padr√£o
    status_pagamento VARCHAR(20) DEFAULT 'PENDENTE'
        CHECK (status_pagamento IN ('PENDENTE', 'PAGO', 'CANCELADO'))
);

-- ‚úîÔ∏è Regras aplicadas:
-- - numero_nota_fiscal √© √∫nico
-- - data_venda usa CURRENT_TIMESTAMP por padr√£o
-- - status_pagamento usa 'PENDENTE' por padr√£o
-- - forma_pagamento e status_pagamento t√™m valores restritos via CHECK


================================================================================
                              RESUMO DA AULA
================================================================================

‚úÖ O QUE APRENDEMOS:

   TIPOS DE DADOS:
   ‚Ä¢ Num√©ricos: INTEGER, BIGINT, SERIAL, DECIMAL, REAL
   ‚Ä¢ Texto: CHAR, VARCHAR, TEXT
   ‚Ä¢ Data/Hora: DATE, TIME, TIMESTAMP, INTERVAL
   ‚Ä¢ Booleano: BOOLEAN
   ‚Ä¢ Especiais: UUID, JSON, ARRAY

   CONSTRAINTS:
   ‚Ä¢ NOT NULL ‚Üí campo obrigat√≥rio
   ‚Ä¢ DEFAULT ‚Üí valor padr√£o autom√°tico
   ‚Ä¢ UNIQUE ‚Üí sem duplicatas
   ‚Ä¢ CHECK ‚Üí valida√ß√£o customizada

   FUN√á√ïES √öTEIS:
   ‚Ä¢ CURRENT_DATE, CURRENT_TIME, NOW()
   ‚Ä¢ CURRENT_TIMESTAMP

üìö TAREFA PARA CASA:
   1. Fazer exerc√≠cios 11-20 da lista geral
   2. Explorar tipos de dados na documenta√ß√£o
   3. Criar tabelas para um mini-projeto pessoal

üîú PR√ìXIMA AULA:
   DDL Avan√ßado - Relacionamentos e Chaves Estrangeiras
   - PRIMARY KEY vs FOREIGN KEY
   - ON DELETE CASCADE, SET NULL
   - ALTER TABLE (modificar tabelas existentes)
   - DROP, TRUNCATE

================================================================================
                            FIM DA AULA 02
================================================================================
