================================================================================
                              AULA 06 - DIA 6
                        JOINS - RELACIONANDO TABELAS
================================================================================

HOR√ÅRIO: 13:30 - 17:30 | DATA: _____/_____/_____

OBJETIVOS:
‚úì Dominar todos os tipos de JOIN
‚úì Combinar dados de m√∫ltiplas tabelas
‚úì Usar aliases para simplificar queries
‚úì Entender diferen√ßas entre INNER, LEFT, RIGHT, FULL, CROSS, SELF JOIN

CRONOGRAMA:
13:30-13:45 ‚Üí Revis√£o | 13:45-14:45 ‚Üí INNER e LEFT JOIN
14:45-15:30 ‚Üí RIGHT, FULL, CROSS | 15:30-15:45 ‚Üí Intervalo
15:45-17:00 ‚Üí SELF JOIN e pr√°tica | 17:00-17:30 ‚Üí Exerc√≠cios

================================================================================
PARTE 1: INNER JOIN
================================================================================

-- INNER JOIN: retorna apenas linhas com correspond√™ncia EM AMBAS as tabelas

SELECT 
    f.nome AS funcionario,
    d.nome AS departamento
FROM funcionarios f
INNER JOIN departamentos d ON f.departamento_id = d.id;

-- Apenas funcion√°rios que T√äM departamento
-- Funcion√°rios sem departamento (NULL) N√ÉO aparecem

-- JOIN com m√∫ltiplas tabelas:
SELECT 
    c.nome AS cliente,
    p.data_pedido,
    prod.nome AS produto,
    ip.quantidade
FROM clientes c
INNER JOIN pedidos p ON c.id = p.cliente_id
INNER JOIN itens_pedido ip ON p.id = ip.pedido_id
INNER JOIN produtos prod ON ip.produto_id = prod.id;

/*
üí° ALIASES (f, d, c, p):
   - Simplificam a escrita
   - Obrigat√≥rios quando h√° colunas com mesmo nome
   - Conven√ß√£o: primeiras letras da tabela
*/

================================================================================
PARTE 2: LEFT JOIN (LEFT OUTER JOIN)
================================================================================

-- LEFT JOIN: retorna TODAS as linhas da tabela da ESQUERDA + correspond√™ncias

SELECT 
    c.nome AS cliente,
    p.id AS pedido_id,
    p.valor_total
FROM clientes c
LEFT JOIN pedidos p ON c.id = p.cliente_id;

-- Resultado: TODOS os clientes, mesmo sem pedidos
-- Clientes sem pedidos ter√£o NULL nas colunas de pedidos

-- Encontrar clientes SEM pedidos:
SELECT c.nome
FROM clientes c
LEFT JOIN pedidos p ON c.id = p.cliente_id
WHERE p.id IS NULL;

================================================================================
PARTE 3: RIGHT JOIN E FULL OUTER JOIN
================================================================================

-- RIGHT JOIN: oposto do LEFT (todas da direita)
SELECT 
    p.id,
    c.nome
FROM pedidos p
RIGHT JOIN clientes c ON p.cliente_id = c.id;
-- Mesma coisa que LEFT JOIN invertendo ordem das tabelas

-- FULL OUTER JOIN: TODAS as linhas de AMBAS
SELECT 
    f.nome,
    d.nome
FROM funcionarios f
FULL OUTER JOIN departamentos d ON f.departamento_id = d.id;
-- Mostra: funcion√°rios sem depto + deptos sem funcion√°rios + correspond√™ncias

================================================================================
PARTE 4: CROSS JOIN (PRODUTO CARTESIANO)
================================================================================

-- CROSS JOIN: combina CADA linha da tabela A com CADA linha da tabela B

SELECT 
    c.nome AS cor,
    t.nome AS tamanho
FROM cores c
CROSS JOIN tamanhos t;

-- Se cores = [Azul, Verde] e tamanhos = [P, M, G]
-- Resultado:
-- Azul-P, Azul-M, Azul-G, Verde-P, Verde-M, Verde-G

/*
‚ö†Ô∏è CUIDADO: CROSS JOIN pode gerar MUITAS linhas!
   1000 produtos √ó 1000 clientes = 1.000.000 linhas!
*/

================================================================================
PARTE 5: SELF JOIN (TABELA COM ELA MESMA)
================================================================================

-- SELF JOIN: juntar tabela consigo mesma (usar aliases diferentes!)

-- Exemplo: hierarquia de funcion√°rios (funcion√°rio ‚Üí gerente)
SELECT 
    f.nome AS funcionario,
    g.nome AS gerente
FROM funcionarios f
LEFT JOIN funcionarios g ON f.gerente_id = g.id;

-- Encontrar pares de funcion√°rios do mesmo departamento:
SELECT 
    f1.nome AS funcionario1,
    f2.nome AS funcionario2,
    f1.departamento_id
FROM funcionarios f1
INNER JOIN funcionarios f2 
    ON f1.departamento_id = f2.departamento_id
    AND f1.id < f2.id;  -- Evita duplicatas (A-B = B-A)

================================================================================
EXERC√çCIOS PR√ÅTICOS
================================================================================

üí™ EXERC√çCIO 1: Sistema de Vendas (15 min)
Crie queries com JOIN para:
a) Listar todos os pedidos com nome do cliente
b) Mostrar produtos vendidos com nome do cliente que comprou
c) Encontrar clientes que NUNCA fizeram pedidos (LEFT JOIN + IS NULL)

üí™ EXERC√çCIO 2: Relat√≥rios (15 min)
a) Total de vendas por categoria de produto (JOIN + GROUP BY)
b) Funcion√°rios e seus gerentes (SELF JOIN)
c) Produtos e categorias, incluindo produtos sem categoria

üí™ EXERC√çCIO 3: Queries Complexas (20 min)
a) 3+ tabelas: pedido ‚Üí cliente ‚Üí cidade + produto ‚Üí categoria
b) Encontrar departamentos sem funcion√°rios (RIGHT/FULL JOIN)
c) Todos os alunos e todas as disciplinas (CROSS JOIN)

RESUMO:
‚Ä¢ INNER JOIN ‚Üí apenas correspond√™ncias
‚Ä¢ LEFT JOIN ‚Üí todas da esquerda + correspond√™ncias
‚Ä¢ RIGHT JOIN ‚Üí todas da direita + correspond√™ncias
‚Ä¢ FULL JOIN ‚Üí todas de ambas
‚Ä¢ CROSS JOIN ‚Üí todas as combina√ß√µes
‚Ä¢ SELF JOIN ‚Üí tabela consigo mesma

TAREFA: Exerc√≠cios 51-60 | PR√ìXIMA AULA: Fun√ß√µes Agregadas e GROUP BY

================================================================================
FIM DA AULA 06
================================================================================
